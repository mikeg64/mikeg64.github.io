<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hermes-docs: src/bvals_mhd.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hermes-docs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('bvals__mhd_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bvals_mhd.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Sets boundary conditions (quantities in ghost zones) on each edge of a Grid for the MHD variables.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="copyright_8h_source.html">copyright.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="defs_8h_source.html">defs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="athena_8h_source.html">athena.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globals_8h_source.html">globals.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="prototypes_8h_source.html">prototypes.h</a>&quot;</code><br />
</div>
<p><a href="bvals__mhd_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab450dc8f6ddc146aab7dcc71c0795253"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bvals__mhd_8c.html#ab450dc8f6ddc146aab7dcc71c0795253">bvals_mhd</a> (<a class="el" href="struct_domain_s.html">DomainS</a> *pD)</td></tr>
<tr class="memdesc:ab450dc8f6ddc146aab7dcc71c0795253"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls appropriate functions to set ghost zones. <br  />
  <a href="bvals__mhd_8c.html#ab450dc8f6ddc146aab7dcc71c0795253">More...</a><br /></td></tr>
<tr class="separator:ab450dc8f6ddc146aab7dcc71c0795253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73fd08ad3c131672ff0473236faee5e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bvals__mhd_8c.html#a73fd08ad3c131672ff0473236faee5e2">bvals_mhd_init</a> (<a class="el" href="struct_mesh_s.html">MeshS</a> *pM)</td></tr>
<tr class="memdesc:a73fd08ad3c131672ff0473236faee5e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets function pointers for physical boundaries during initialization, allocates memory for send/receive buffers with MPI.  <a href="bvals__mhd_8c.html#a73fd08ad3c131672ff0473236faee5e2">More...</a><br /></td></tr>
<tr class="separator:a73fd08ad3c131672ff0473236faee5e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f18bdb818b65c7946c7dc7d63b7cdb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bvals__mhd_8c.html#a8f18bdb818b65c7946c7dc7d63b7cdb3">bvals_mhd_fun</a> (<a class="el" href="struct_domain_s.html">DomainS</a> *pD, enum <a class="el" href="athena_8h.html#a3c1bd98b7783340b3ff1dd2fcea56df4">BCDirection</a> dir, <a class="el" href="athena_8h.html#a665c6a09a1b144dc16774a5b74040387">VGFun_t</a> prob_bc)</td></tr>
<tr class="memdesc:a8f18bdb818b65c7946c7dc7d63b7cdb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets function ptrs for user-defined BCs.  <a href="bvals__mhd_8c.html#a8f18bdb818b65c7946c7dc7d63b7cdb3">More...</a><br /></td></tr>
<tr class="separator:a8f18bdb818b65c7946c7dc7d63b7cdb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sets boundary conditions (quantities in ghost zones) on each edge of a Grid for the MHD variables. </p>
<p>PURPOSE: Sets boundary conditions (quantities in ghost zones) on each edge of a Grid for the MHD variables. Each edge of a Grid represents either:</p><ul>
<li>(1) a physical boundary at the edge of the Mesh; in which case BCs are specified by an integer flag input by user (or by user-defined BC function in the problem file)</li>
<li>(2) the boundary between Grids resulting from decomposition of a larger Domain using MPI; in which case BCs are handled by MPI calls</li>
<li><p class="startli">(3) an internal boundary between fine/coarse grid levels in a nested Mesh; in which case the BCs require a prolongation operator from the parent</p>
<p class="startli">This file contains functions that can handle the first two cases. Case (3) is handled in the Prolongate function called from main loop. The naming convention of the integer flags for BCs is:</p><ul>
<li>bc_ix1 = Boundary Condition for Inner x1 (at i=is)</li>
<li>bc_ox1 = Boundary Condition for Outer x1 (at i=ie) similarly for bc_ix2; bc_ox2; bc_ix3; bc_ox3</li>
</ul>
</li>
</ul>
<p>For case (1) &ndash; PHYSICAL BOUNDARIES The values of the integer flags (bc_ix1, etc.) are:</p><ul>
<li>1 = reflecting; 2 = outflow; 4 = periodic; 5 = conductor For flow-in bondaries (ghost zones set to pre-determined values), pointers to user-defined functions in the problem file are used.</li>
</ul>
<p>For case (2) &ndash; MPI BOUNDARIES We do the parallel synchronization by having every grid:</p><ul>
<li>1) Post non-blocking receives for data from both L and R Grids</li>
<li>2) Pack and send data to the Grids on both L and R</li>
<li>3) Check for receives and unpack data in order of first to finish If the Grid is at the edge of the Domain, we set BCs as in case (1) or (3).</li>
</ul>
<p>For case (3) &ndash; INTERNAL GRID LEVEL BOUNDARIES This step is complicated and must be handled separately, in the function <a class="el" href="prototypes_8h.html#ad2fa4773d22ac52368d121fbc64753b8">Prolongate()</a> called from the main loop. In the algorithm below, nothing is done for this case; the BCs are left to be set later.</p>
<p>With SELF-GRAVITY: BCs for Phi are set independently of the MHD variables in a separate function bvals_grav().</p>
<p>CONTAINS PUBLIC FUNCTIONS:</p><ul>
<li><a class="el" href="bvals__mhd_8c.html#ab450dc8f6ddc146aab7dcc71c0795253" title="Calls appropriate functions to set ghost zones.">bvals_mhd()</a> - calls appropriate functions to set ghost cells</li>
<li><a class="el" href="bvals__mhd_8c.html#a73fd08ad3c131672ff0473236faee5e2" title="Sets function pointers for physical boundaries during initialization, allocates memory for send/recei...">bvals_mhd_init()</a> - sets function pointers used by <a class="el" href="bvals__mhd_8c.html#ab450dc8f6ddc146aab7dcc71c0795253" title="Calls appropriate functions to set ghost zones.">bvals_mhd()</a></li>
<li><a class="el" href="bvals__mhd_8c.html#a8f18bdb818b65c7946c7dc7d63b7cdb3" title="Sets function ptrs for user-defined BCs.">bvals_mhd_fun()</a> - enrolls a pointer to a user-defined BC function</li>
</ul>
<p>PRIVATE FUNCTION PROTOTYPES:</p><ul>
<li>reflect_ix1() - reflecting BCs at boundary ix1</li>
<li>reflect_ox1() - reflecting BCs at boundary ox1</li>
<li>reflect_ix2() - reflecting BCs at boundary ix2</li>
<li>reflect_ox2() - reflecting BCs at boundary ox2</li>
<li>reflect_ix3() - reflecting BCs at boundary ix3</li>
<li>reflect_ox3() - reflecting BCs at boundary ox3</li>
<li>outflow_ix1() - outflow BCs at boundary ix1</li>
<li>outflow_ox1() - outflow BCs at boundary ox1</li>
<li>outflow_ix2() - outflow BCs at boundary ix2</li>
<li>outflow_ox2() - outflow BCs at boundary ox2</li>
<li>outflow_ix3() - outflow BCs at boundary ix3</li>
<li>outflow_ox3() - outflow BCs at boundary ox3</li>
<li>periodic_ix1() - periodic BCs at boundary ix1</li>
<li>periodic_ox1() - periodic BCs at boundary ox1</li>
<li>periodic_ix2() - periodic BCs at boundary ix2</li>
<li>periodic_ox2() - periodic BCs at boundary ox2</li>
<li>periodic_ix3() - periodic BCs at boundary ix3</li>
<li>periodic_ox3() - periodic BCs at boundary ox3</li>
<li>conduct_ix1() - conducting BCs at boundary ix1</li>
<li>conduct_ox1() - conducting BCs at boundary ox1</li>
<li>conduct_ix2() - conducting BCs at boundary ix2</li>
<li>conduct_ox2() - conducting BCs at boundary ox2</li>
<li>conduct_ix3() - conducting BCs at boundary ix3</li>
<li>conduct_ox3() - conducting BCs at boundary ox3</li>
<li>pack_ix1() - pack data for MPI non-blocking send at ix1 boundary</li>
<li>pack_ox1() - pack data for MPI non-blocking send at ox1 boundary</li>
<li>pack_ix2() - pack data for MPI non-blocking send at ix2 boundary</li>
<li>pack_ox2() - pack data for MPI non-blocking send at ox2 boundary</li>
<li>pack_ix3() - pack data for MPI non-blocking send at ix3 boundary</li>
<li>pack_ox3() - pack data for MPI non-blocking send at ox3 boundary</li>
<li>unpack_ix1() - unpack data for MPI non-blocking receive at ix1 boundary</li>
<li>unpack_ox1() - unpack data for MPI non-blocking receive at ox1 boundary</li>
<li>unpack_ix2() - unpack data for MPI non-blocking receive at ix2 boundary</li>
<li>unpack_ox2() - unpack data for MPI non-blocking receive at ox2 boundary</li>
<li>unpack_ix3() - unpack data for MPI non-blocking receive at ix3 boundary</li>
<li>unpack_ox3() - unpack data for MPI non-blocking receive at ox3 boundary </li>
</ul>

<p class="definition">Definition in file <a class="el" href="bvals__mhd_8c_source.html">bvals_mhd.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ab450dc8f6ddc146aab7dcc71c0795253"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab450dc8f6ddc146aab7dcc71c0795253">&#9670;&nbsp;</a></span>bvals_mhd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvals_mhd </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_domain_s.html">DomainS</a> *&#160;</td>
          <td class="paramname"><em>pD</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls appropriate functions to set ghost zones. <br  />
 </p>
<p>The function pointers (*(pD-&gt;???_BCFun)) are set by bvals_init() to be either a user-defined function, or one of the functions corresponding to reflecting, periodic, or outflow. If the left- or right-Grid ID numbers are &gt;= 1 (neighboring grids exist), then MPI calls are used.</p>
<p>Order for updating boundary conditions must always be x1-x2-x3 in order to fill the corner cells properly </p>

<p class="definition">Definition at line <a class="el" href="bvals__mhd_8c_source.html#l00174">174</a> of file <a class="el" href="bvals__mhd_8c_source.html">bvals_mhd.c</a>.</p>

</div>
</div>
<a id="a8f18bdb818b65c7946c7dc7d63b7cdb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f18bdb818b65c7946c7dc7d63b7cdb3">&#9670;&nbsp;</a></span>bvals_mhd_fun()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvals_mhd_fun </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_domain_s.html">DomainS</a> *&#160;</td>
          <td class="paramname"><em>pD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="athena_8h.html#a3c1bd98b7783340b3ff1dd2fcea56df4">BCDirection</a>&#160;</td>
          <td class="paramname"><em>dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="athena_8h.html#a665c6a09a1b144dc16774a5b74040387">VGFun_t</a>&#160;</td>
          <td class="paramname"><em>prob_bc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets function ptrs for user-defined BCs. </p>

<p class="definition">Definition at line <a class="el" href="bvals__mhd_8c_source.html#l00915">915</a> of file <a class="el" href="bvals__mhd_8c_source.html">bvals_mhd.c</a>.</p>

</div>
</div>
<a id="a73fd08ad3c131672ff0473236faee5e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73fd08ad3c131672ff0473236faee5e2">&#9670;&nbsp;</a></span>bvals_mhd_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bvals_mhd_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_mesh_s.html">MeshS</a> *&#160;</td>
          <td class="paramname"><em>pM</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets function pointers for physical boundaries during initialization, allocates memory for send/receive buffers with MPI. </p>

<p class="definition">Definition at line <a class="el" href="bvals__mhd_8c_source.html#l00514">514</a> of file <a class="el" href="bvals__mhd_8c_source.html">bvals_mhd.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="bvals__mhd_8c.html">bvals_mhd.c</a></li>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
