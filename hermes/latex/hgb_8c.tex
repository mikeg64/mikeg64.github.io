\hypertarget{hgb_8c}{}\doxysection{src/prob/hgb.c File Reference}
\label{hgb_8c}\index{src/prob/hgb.c@{src/prob/hgb.c}}


Problem generator for 3D shearing sheet.  


{\ttfamily \#include \char`\"{}copyright.\+h\char`\"{}}\newline
{\ttfamily \#include $<$float.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}defs.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}athena.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}globals.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}prototypes.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}particles/particle.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{hgb_8c_a78325bdf48423acef7c012567628b391}{I\+M1}}~2147483563
\item 
\#define \mbox{\hyperlink{hgb_8c_ad8c519de7e5de4ae35344ddcf21fd062}{I\+M2}}~2147483399
\item 
\#define \mbox{\hyperlink{hgb_8c_ad301e6a88b1c01108f4867f2ea6f683c}{AM}}~(1.\+0/\mbox{\hyperlink{turb_8c_a78325bdf48423acef7c012567628b391}{I\+M1}})
\item 
\#define \mbox{\hyperlink{hgb_8c_a87a6e0054f9d827c979c43aa0d5e621a}{I\+M\+M1}}~(\mbox{\hyperlink{turb_8c_a78325bdf48423acef7c012567628b391}{I\+M1}}-\/1)
\item 
\#define \mbox{\hyperlink{hgb_8c_a6ef2749dca39c605c3d033f788afe6e3}{I\+A1}}~40014
\item 
\#define \mbox{\hyperlink{hgb_8c_a372a58d7e9e25912fd79e7afaa06cc7a}{I\+A2}}~40692
\item 
\#define \mbox{\hyperlink{hgb_8c_a9afa86ff22da69bda72fe271ae71ad46}{I\+Q1}}~53668
\item 
\#define \mbox{\hyperlink{hgb_8c_abae040385946a6acdf5e10d2efd86f3d}{I\+Q2}}~52774
\item 
\#define \mbox{\hyperlink{hgb_8c_a7b2b32709f9770a283701ffcf3723497}{I\+R1}}~12211
\item 
\#define \mbox{\hyperlink{hgb_8c_a5a08e4f5cb3582e623cc14a6c92d48de}{I\+R2}}~3791
\item 
\#define \mbox{\hyperlink{hgb_8c_a0e93cfb2d62849853fd34957ba6e6fdc}{N\+T\+AB}}~32
\item 
\#define \mbox{\hyperlink{hgb_8c_a62339d74dd5d9d00480e1a288cf88fe8}{N\+D\+IV}}~(1+\mbox{\hyperlink{turb_8c_a87a6e0054f9d827c979c43aa0d5e621a}{I\+M\+M1}}/\mbox{\hyperlink{turb_8c_a0e93cfb2d62849853fd34957ba6e6fdc}{N\+T\+AB}})
\item 
\#define \mbox{\hyperlink{hgb_8c_aa7436c9270ffb06f8c1eae8d2e605cec}{R\+N\+MX}}~(1.\+0-\/D\+B\+L\+\_\+\+E\+P\+S\+I\+L\+ON)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{hgb_8c_a1b323f47153f1975b64382e0ffac6b73}{problem}} (\mbox{\hyperlink{struct_domain_s}{DomainS}} $\ast$p\+Domain)
\item 
void \mbox{\hyperlink{hgb_8c_a2c334369ab621e9815591c76ccfb5fc7}{problem\+\_\+write\+\_\+restart}} (\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$pM, F\+I\+LE $\ast$fp)
\item 
void \mbox{\hyperlink{hgb_8c_acf733c9792756cbec1e9d226c4ff37ab}{problem\+\_\+read\+\_\+restart}} (\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$pM, F\+I\+LE $\ast$fp)
\item 
\mbox{\hyperlink{athena_8h_aaa64b3ee5eefc566b7c09368c414de89}{Cons\+Fun\+\_\+t}} \mbox{\hyperlink{hgb_8c_a4575c4cdbf2965a9857c45970d736676}{get\+\_\+usr\+\_\+expr}} (const char $\ast$expr)
\item 
\mbox{\hyperlink{athena_8h_a8bc2403d4d3a27d6f475f2dc6acc94cc}{V\+Out\+Fun\+\_\+t}} \mbox{\hyperlink{hgb_8c_a8b8cabb1061d5399fb492be89de213ff}{get\+\_\+usr\+\_\+out\+\_\+fun}} (const char $\ast$\mbox{\hyperlink{streaming3d__single_8c_ae5cb967283dbbdf75cb2032c1fa08fee}{name}})
\item 
void \mbox{\hyperlink{hgb_8c_a0ff640c24db1dc0d7c89d91f1d55ffce}{Userwork\+\_\+in\+\_\+loop}} (\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$pM)
\item 
void \mbox{\hyperlink{hgb_8c_a5506a1df41ed88e038443271b9785337}{Userwork\+\_\+after\+\_\+loop}} (\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$pM)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
Real \mbox{\hyperlink{hgb_8c_a10d2aeede3b35b41ed5633b7607e1694}{Lx}}
\item 
Real \mbox{\hyperlink{hgb_8c_aeb4161c18cffa7f9fec69ca9f468fe1b}{Ly}}
\item 
Real \mbox{\hyperlink{hgb_8c_af95c144ac358e2018a86d47119351bb3}{Lz}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Problem generator for 3D shearing sheet. 

P\+U\+R\+P\+O\+SE\+: Problem generator for 3D shearing sheet. Based on the initial conditions described in \char`\"{}\+Local Three-\/dimensional Magnetohydrodynamic
   Simulations of Accretion Disks\char`\"{} by Hawley, Gammie \& Balbus, or H\+GB.

Several different field configurations and perturbations are possible\+:


\begin{DoxyItemize}
\item ifield = 0 -\/ uses field set by choice of ipert flag
\item ifield = 1 -\/ Bz=B0sin(kx$\ast$x1) field with zero-\/net-\/flux \mbox{[}default\mbox{]} (kx input)
\item ifield = 2 -\/ uniform Bz
\item ifield = 3 -\/ B=(0,B0cos(kx$\ast$x1),B0sin(kx$\ast$x1))= zero-\/net flux w helicity
\item ifield = 4 -\/ B=(0,B0/sqrt(2),B0/sqrt(2))= net toroidal+vertical field
\item ifield = 5 -\/ uniform By
\item ipert = 1 -\/ random perturbations to P and V \mbox{[}default, used by H\+GB\mbox{]}
\item ipert = 2 -\/ uniform Vx=amp (epicyclic wave test)
\item ipert = 3 -\/ J\&G vortical shwave (hydro test)
\item ipert = 4 -\/ nonlinear density wave test of Fromang \& Papaloizou
\item ipert = 5 -\/ 2nd M\+HD shwave test of J\+GG (2008) -- their figure 9
\item ipert = 6 -\/ 3rd M\+HD shwave test of J\+GG (2008) -- their figure 11
\item ipert = 7 -\/ nonlinear shearing wave test of Heinemann \& Papaloizou (2008)

To run simulations of stratified disks (including vertical gravity), use the \mbox{\hyperlink{strat_8c}{strat.\+c}} problem generator.

Code must be configured using --enable-\/shearing-\/box

R\+E\+F\+E\+R\+E\+N\+CE\+: Hawley, J. F. \& Balbus, S. A., ApJ 400, 595-\/609 (1992). Johnson, Guan, \& Gammie, Ap\+J\+Supp, (2008) ~\newline
 
\end{DoxyItemize}

\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{hgb_8c_ad301e6a88b1c01108f4867f2ea6f683c}\label{hgb_8c_ad301e6a88b1c01108f4867f2ea6f683c}} 
\index{hgb.c@{hgb.c}!AM@{AM}}
\index{AM@{AM}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{AM}{AM}}
{\footnotesize\ttfamily \#define AM~(1.\+0/\mbox{\hyperlink{turb_8c_a78325bdf48423acef7c012567628b391}{I\+M1}})}



Definition at line 642 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a6ef2749dca39c605c3d033f788afe6e3}\label{hgb_8c_a6ef2749dca39c605c3d033f788afe6e3}} 
\index{hgb.c@{hgb.c}!IA1@{IA1}}
\index{IA1@{IA1}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IA1}{IA1}}
{\footnotesize\ttfamily \#define I\+A1~40014}



Definition at line 644 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a372a58d7e9e25912fd79e7afaa06cc7a}\label{hgb_8c_a372a58d7e9e25912fd79e7afaa06cc7a}} 
\index{hgb.c@{hgb.c}!IA2@{IA2}}
\index{IA2@{IA2}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IA2}{IA2}}
{\footnotesize\ttfamily \#define I\+A2~40692}



Definition at line 645 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a78325bdf48423acef7c012567628b391}\label{hgb_8c_a78325bdf48423acef7c012567628b391}} 
\index{hgb.c@{hgb.c}!IM1@{IM1}}
\index{IM1@{IM1}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IM1}{IM1}}
{\footnotesize\ttfamily \#define I\+M1~2147483563}



Definition at line 640 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_ad8c519de7e5de4ae35344ddcf21fd062}\label{hgb_8c_ad8c519de7e5de4ae35344ddcf21fd062}} 
\index{hgb.c@{hgb.c}!IM2@{IM2}}
\index{IM2@{IM2}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IM2}{IM2}}
{\footnotesize\ttfamily \#define I\+M2~2147483399}



Definition at line 641 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a87a6e0054f9d827c979c43aa0d5e621a}\label{hgb_8c_a87a6e0054f9d827c979c43aa0d5e621a}} 
\index{hgb.c@{hgb.c}!IMM1@{IMM1}}
\index{IMM1@{IMM1}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IMM1}{IMM1}}
{\footnotesize\ttfamily \#define I\+M\+M1~(\mbox{\hyperlink{turb_8c_a78325bdf48423acef7c012567628b391}{I\+M1}}-\/1)}



Definition at line 643 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a9afa86ff22da69bda72fe271ae71ad46}\label{hgb_8c_a9afa86ff22da69bda72fe271ae71ad46}} 
\index{hgb.c@{hgb.c}!IQ1@{IQ1}}
\index{IQ1@{IQ1}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IQ1}{IQ1}}
{\footnotesize\ttfamily \#define I\+Q1~53668}



Definition at line 646 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_abae040385946a6acdf5e10d2efd86f3d}\label{hgb_8c_abae040385946a6acdf5e10d2efd86f3d}} 
\index{hgb.c@{hgb.c}!IQ2@{IQ2}}
\index{IQ2@{IQ2}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IQ2}{IQ2}}
{\footnotesize\ttfamily \#define I\+Q2~52774}



Definition at line 647 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a7b2b32709f9770a283701ffcf3723497}\label{hgb_8c_a7b2b32709f9770a283701ffcf3723497}} 
\index{hgb.c@{hgb.c}!IR1@{IR1}}
\index{IR1@{IR1}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IR1}{IR1}}
{\footnotesize\ttfamily \#define I\+R1~12211}



Definition at line 648 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a5a08e4f5cb3582e623cc14a6c92d48de}\label{hgb_8c_a5a08e4f5cb3582e623cc14a6c92d48de}} 
\index{hgb.c@{hgb.c}!IR2@{IR2}}
\index{IR2@{IR2}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{IR2}{IR2}}
{\footnotesize\ttfamily \#define I\+R2~3791}



Definition at line 649 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a62339d74dd5d9d00480e1a288cf88fe8}\label{hgb_8c_a62339d74dd5d9d00480e1a288cf88fe8}} 
\index{hgb.c@{hgb.c}!NDIV@{NDIV}}
\index{NDIV@{NDIV}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{NDIV}{NDIV}}
{\footnotesize\ttfamily \#define N\+D\+IV~(1+\mbox{\hyperlink{turb_8c_a87a6e0054f9d827c979c43aa0d5e621a}{I\+M\+M1}}/\mbox{\hyperlink{turb_8c_a0e93cfb2d62849853fd34957ba6e6fdc}{N\+T\+AB}})}



Definition at line 651 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a0e93cfb2d62849853fd34957ba6e6fdc}\label{hgb_8c_a0e93cfb2d62849853fd34957ba6e6fdc}} 
\index{hgb.c@{hgb.c}!NTAB@{NTAB}}
\index{NTAB@{NTAB}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{NTAB}{NTAB}}
{\footnotesize\ttfamily \#define N\+T\+AB~32}



Definition at line 650 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_aa7436c9270ffb06f8c1eae8d2e605cec}\label{hgb_8c_aa7436c9270ffb06f8c1eae8d2e605cec}} 
\index{hgb.c@{hgb.c}!RNMX@{RNMX}}
\index{RNMX@{RNMX}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{RNMX}{RNMX}}
{\footnotesize\ttfamily \#define R\+N\+MX~(1.\+0-\/D\+B\+L\+\_\+\+E\+P\+S\+I\+L\+ON)}



Definition at line 652 of file hgb.\+c.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{hgb_8c_a4575c4cdbf2965a9857c45970d736676}\label{hgb_8c_a4575c4cdbf2965a9857c45970d736676}} 
\index{hgb.c@{hgb.c}!get\_usr\_expr@{get\_usr\_expr}}
\index{get\_usr\_expr@{get\_usr\_expr}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{get\_usr\_expr()}{get\_usr\_expr()}}
{\footnotesize\ttfamily \mbox{\hyperlink{athena_8h_aaa64b3ee5eefc566b7c09368c414de89}{Cons\+Fun\+\_\+t}} get\+\_\+usr\+\_\+expr (\begin{DoxyParamCaption}\item[{const char $\ast$}]{expr }\end{DoxyParamCaption})}



Definition at line 585 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a8b8cabb1061d5399fb492be89de213ff}\label{hgb_8c_a8b8cabb1061d5399fb492be89de213ff}} 
\index{hgb.c@{hgb.c}!get\_usr\_out\_fun@{get\_usr\_out\_fun}}
\index{get\_usr\_out\_fun@{get\_usr\_out\_fun}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{get\_usr\_out\_fun()}{get\_usr\_out\_fun()}}
{\footnotesize\ttfamily \mbox{\hyperlink{athena_8h_a8bc2403d4d3a27d6f475f2dc6acc94cc}{V\+Out\+Fun\+\_\+t}} get\+\_\+usr\+\_\+out\+\_\+fun (\begin{DoxyParamCaption}\item[{const char $\ast$}]{name }\end{DoxyParamCaption})}



Definition at line 592 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a1b323f47153f1975b64382e0ffac6b73}\label{hgb_8c_a1b323f47153f1975b64382e0ffac6b73}} 
\index{hgb.c@{hgb.c}!problem@{problem}}
\index{problem@{problem}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{problem()}{problem()}}
{\footnotesize\ttfamily void problem (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_domain_s}{DomainS}} $\ast$}]{p\+Domain }\end{DoxyParamCaption})}



Definition at line 80 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_acf733c9792756cbec1e9d226c4ff37ab}\label{hgb_8c_acf733c9792756cbec1e9d226c4ff37ab}} 
\index{hgb.c@{hgb.c}!problem\_read\_restart@{problem\_read\_restart}}
\index{problem\_read\_restart@{problem\_read\_restart}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{problem\_read\_restart()}{problem\_read\_restart()}}
{\footnotesize\ttfamily void problem\+\_\+read\+\_\+restart (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$}]{pM,  }\item[{F\+I\+LE $\ast$}]{fp }\end{DoxyParamCaption})}



Definition at line 544 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a2c334369ab621e9815591c76ccfb5fc7}\label{hgb_8c_a2c334369ab621e9815591c76ccfb5fc7}} 
\index{hgb.c@{hgb.c}!problem\_write\_restart@{problem\_write\_restart}}
\index{problem\_write\_restart@{problem\_write\_restart}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{problem\_write\_restart()}{problem\_write\_restart()}}
{\footnotesize\ttfamily void problem\+\_\+write\+\_\+restart (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$}]{pM,  }\item[{F\+I\+LE $\ast$}]{fp }\end{DoxyParamCaption})}



Definition at line 535 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a5506a1df41ed88e038443271b9785337}\label{hgb_8c_a5506a1df41ed88e038443271b9785337}} 
\index{hgb.c@{hgb.c}!Userwork\_after\_loop@{Userwork\_after\_loop}}
\index{Userwork\_after\_loop@{Userwork\_after\_loop}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{Userwork\_after\_loop()}{Userwork\_after\_loop()}}
{\footnotesize\ttfamily void Userwork\+\_\+after\+\_\+loop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$}]{pM }\end{DoxyParamCaption})}



Definition at line 631 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_a0ff640c24db1dc0d7c89d91f1d55ffce}\label{hgb_8c_a0ff640c24db1dc0d7c89d91f1d55ffce}} 
\index{hgb.c@{hgb.c}!Userwork\_in\_loop@{Userwork\_in\_loop}}
\index{Userwork\_in\_loop@{Userwork\_in\_loop}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{Userwork\_in\_loop()}{Userwork\_in\_loop()}}
{\footnotesize\ttfamily void Userwork\+\_\+in\+\_\+loop (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_mesh_s}{MeshS}} $\ast$}]{pM }\end{DoxyParamCaption})}



Definition at line 627 of file hgb.\+c.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{hgb_8c_a10d2aeede3b35b41ed5633b7607e1694}\label{hgb_8c_a10d2aeede3b35b41ed5633b7607e1694}} 
\index{hgb.c@{hgb.c}!Lx@{Lx}}
\index{Lx@{Lx}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{Lx}{Lx}}
{\footnotesize\ttfamily Real Lx}



Definition at line 47 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_aeb4161c18cffa7f9fec69ca9f468fe1b}\label{hgb_8c_aeb4161c18cffa7f9fec69ca9f468fe1b}} 
\index{hgb.c@{hgb.c}!Ly@{Ly}}
\index{Ly@{Ly}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{Ly}{Ly}}
{\footnotesize\ttfamily Real Ly}



Definition at line 47 of file hgb.\+c.

\mbox{\Hypertarget{hgb_8c_af95c144ac358e2018a86d47119351bb3}\label{hgb_8c_af95c144ac358e2018a86d47119351bb3}} 
\index{hgb.c@{hgb.c}!Lz@{Lz}}
\index{Lz@{Lz}!hgb.c@{hgb.c}}
\doxysubsubsection{\texorpdfstring{Lz}{Lz}}
{\footnotesize\ttfamily Real Lz}



Definition at line 47 of file hgb.\+c.

