\hypertarget{ath__log_8c}{}\doxysection{src/ath\+\_\+log.c File Reference}
\label{ath__log_8c}\index{src/ath\_log.c@{src/ath\_log.c}}


Functions for controlling output to stderr and stdout.  


{\ttfamily \#include \char`\"{}copyright.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdarg.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$sys/types.\+h$>$}\newline
{\ttfamily \#include $<$sys/stat.\+h$>$}\newline
{\ttfamily \#include \char`\"{}prototypes.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{ath__log_8c_a7add156c56dde5a523942cece2760819}{ath\+\_\+log\+\_\+set\+\_\+level}} (const int out, const int err)
\begin{DoxyCompactList}\small\item\em Sets \char`\"{}output level\char`\"{} and \char`\"{}error level\char`\"{} from input arguments, global parameters used by many functions in this file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ath__log_8c_af69817089bbb5b2d033aa588cbe54b89}{ath\+\_\+log\+\_\+open}} (const char $\ast$basename, const int lazy, const char $\ast$\mbox{\hyperlink{iotypes_8h_a1a6b6fb557d8d37d59700faf4e4c9167}{mode}})
\begin{DoxyCompactList}\small\item\em Opens output and error log files if \char`\"{}lazy\char`\"{} flag is false (0). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ath__log_8c_a6ea3302c606292e0511ef451f0d5b78b}{ath\+\_\+log\+\_\+close}} (void)
\begin{DoxyCompactList}\small\item\em Closes output and error log files. \end{DoxyCompactList}\item 
F\+I\+LE $\ast$ \mbox{\hyperlink{ath__log_8c_ad1aa66eb6e7af73976ce23f83e38a068}{athout\+\_\+fp}} (void)
\begin{DoxyCompactList}\small\item\em Open output file if needed and return a pointer to file. \end{DoxyCompactList}\item 
F\+I\+LE $\ast$ \mbox{\hyperlink{ath__log_8c_ad4fe019acf86bdfb9ab014b2f3ab10da}{atherr\+\_\+fp}} (void)
\begin{DoxyCompactList}\small\item\em Open error file if needed and return a pointer to file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ath__log_8c_add8ed1d287dead804cbac46fdbfad1e9}{ath\+\_\+flush\+\_\+out}} (void)
\begin{DoxyCompactList}\small\item\em Flush output file buffer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ath__log_8c_a707825963151da1fcaf76d5b523ca0cf}{ath\+\_\+flush\+\_\+err}} (void)
\begin{DoxyCompactList}\small\item\em Flush error file buffer. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{ath__log_8c_af21347278c9b783a269474386c4289c5}{ath\+\_\+perr}} (const int level, const char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em Foutput variable argument string to \char`\"{}error log file\char`\"{}. ~\newline
 \end{DoxyCompactList}\item 
int \mbox{\hyperlink{ath__log_8c_a4d9be5e0a6376ae96b3de9d9bb754c10}{ath\+\_\+pout}} (const int level, const char $\ast$fmt,...)
\begin{DoxyCompactList}\small\item\em Output variable argument string to \char`\"{}output log file\char`\"{}. ~\newline
 \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Functions for controlling output to stderr and stdout. 

P\+U\+R\+P\+O\+SE\+: Functions for controlling output to stderr and stdout. On many machines, output to stderr and stdout does not scale well (to 10$^\wedge$\{4-\/5\} processors). However, having output from all M\+PI processes can be useful for debugging. Thus, some kind of runtime control that allows output to stderr and stdout be turned off for production runs, or redirected to files for debugging, is very helpful. To use these functions, replace calls to \mbox{\hyperlink{bound1_01__periodic_8c_af78c08230cfb359c602f3b9899ec146d}{printf()}} with \mbox{\hyperlink{ath__log_8c_af21347278c9b783a269474386c4289c5}{ath\+\_\+perr()}} and \mbox{\hyperlink{ath__log_8c_a4d9be5e0a6376ae96b3de9d9bb754c10}{ath\+\_\+pout()}}, with first argument\+: -\/1 \+: all processes write output 0 \+: only root process writes output 1 \+: neither root nor child processes write output The above is based on the default values (0) of the out\+\_\+level and err\+\_\+level parameters in the $<$log$>$ block. To make the code more verbose (or quieter), these parameters can be changed at run time in the input file. For example setting them to 1 will cause all processes to generate output.

C\+O\+N\+T\+A\+I\+NS P\+U\+B\+L\+IC F\+U\+N\+C\+T\+I\+O\+NS\+:
\begin{DoxyItemize}
\item ath\+\_\+log\+\_\+out\+\_\+open() -\/ opens out log file
\item ath\+\_\+log\+\_\+err\+\_\+open() -\/ opens err log file
\item \mbox{\hyperlink{ath__log_8c_a7add156c56dde5a523942cece2760819}{ath\+\_\+log\+\_\+set\+\_\+level()}} -\/ sets logging level from input arguments
\item \mbox{\hyperlink{ath__log_8c_af69817089bbb5b2d033aa588cbe54b89}{ath\+\_\+log\+\_\+open()}} -\/ calls output/error log file open if lazy == 0
\item \mbox{\hyperlink{ath__log_8c_a6ea3302c606292e0511ef451f0d5b78b}{ath\+\_\+log\+\_\+close()}} -\/ closes output/error log file close
\item \mbox{\hyperlink{ath__log_8c_ad1aa66eb6e7af73976ce23f83e38a068}{athout\+\_\+fp()}} -\/ returns pointer to out logfile
\item \mbox{\hyperlink{ath__log_8c_ad4fe019acf86bdfb9ab014b2f3ab10da}{atherr\+\_\+fp()}} -\/ returns pointer to err logfile
\item \mbox{\hyperlink{ath__log_8c_add8ed1d287dead804cbac46fdbfad1e9}{ath\+\_\+flush\+\_\+out()}} -\/ flushes out log file
\item \mbox{\hyperlink{ath__log_8c_a707825963151da1fcaf76d5b523ca0cf}{ath\+\_\+flush\+\_\+err()}} -\/ flushes err log file
\item \mbox{\hyperlink{ath__log_8c_af21347278c9b783a269474386c4289c5}{ath\+\_\+perr()}} -\/ writes to err file
\item \mbox{\hyperlink{ath__log_8c_a4d9be5e0a6376ae96b3de9d9bb754c10}{ath\+\_\+pout()}} -\/ writes to out file ~\newline
 
\end{DoxyItemize}

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{ath__log_8c_a707825963151da1fcaf76d5b523ca0cf}\label{ath__log_8c_a707825963151da1fcaf76d5b523ca0cf}} 
\index{ath\_log.c@{ath\_log.c}!ath\_flush\_err@{ath\_flush\_err}}
\index{ath\_flush\_err@{ath\_flush\_err}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_flush\_err()}{ath\_flush\_err()}}
{\footnotesize\ttfamily void ath\+\_\+flush\+\_\+err (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Flush error file buffer. 



Definition at line 241 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_add8ed1d287dead804cbac46fdbfad1e9}\label{ath__log_8c_add8ed1d287dead804cbac46fdbfad1e9}} 
\index{ath\_log.c@{ath\_log.c}!ath\_flush\_out@{ath\_flush\_out}}
\index{ath\_flush\_out@{ath\_flush\_out}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_flush\_out()}{ath\_flush\_out()}}
{\footnotesize\ttfamily void ath\+\_\+flush\+\_\+out (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Flush output file buffer. 



Definition at line 226 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_a6ea3302c606292e0511ef451f0d5b78b}\label{ath__log_8c_a6ea3302c606292e0511ef451f0d5b78b}} 
\index{ath\_log.c@{ath\_log.c}!ath\_log\_close@{ath\_log\_close}}
\index{ath\_log\_close@{ath\_log\_close}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_log\_close()}{ath\_log\_close()}}
{\footnotesize\ttfamily void ath\+\_\+log\+\_\+close (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Closes output and error log files. 



Definition at line 180 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_af69817089bbb5b2d033aa588cbe54b89}\label{ath__log_8c_af69817089bbb5b2d033aa588cbe54b89}} 
\index{ath\_log.c@{ath\_log.c}!ath\_log\_open@{ath\_log\_open}}
\index{ath\_log\_open@{ath\_log\_open}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_log\_open()}{ath\_log\_open()}}
{\footnotesize\ttfamily void ath\+\_\+log\+\_\+open (\begin{DoxyParamCaption}\item[{const char $\ast$}]{basename,  }\item[{const int}]{lazy,  }\item[{const char $\ast$}]{mode }\end{DoxyParamCaption})}



Opens output and error log files if \char`\"{}lazy\char`\"{} flag is false (0). 

If \char`\"{}lazy\char`\"{} is true, then the \mbox{\hyperlink{ath__log_8c_af69817089bbb5b2d033aa588cbe54b89}{ath\+\_\+log\+\_\+open()}} call does not actually open the files, but rather prepares to open them on the first invocation of either \mbox{\hyperlink{ath__log_8c_a4d9be5e0a6376ae96b3de9d9bb754c10}{ath\+\_\+pout()}} \mbox{\hyperlink{ath__log_8c_af21347278c9b783a269474386c4289c5}{ath\+\_\+perr()}}, \mbox{\hyperlink{ath__log_8c_ad1aa66eb6e7af73976ce23f83e38a068}{athout\+\_\+fp()}} or \mbox{\hyperlink{ath__log_8c_ad4fe019acf86bdfb9ab014b2f3ab10da}{atherr\+\_\+fp()}}. This is useful for parallel jobs where the children, if made sufficiently quiet would otherwise generate a large number of empty files. -- T. A. Gardiner -- 

Definition at line 141 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_a7add156c56dde5a523942cece2760819}\label{ath__log_8c_a7add156c56dde5a523942cece2760819}} 
\index{ath\_log.c@{ath\_log.c}!ath\_log\_set\_level@{ath\_log\_set\_level}}
\index{ath\_log\_set\_level@{ath\_log\_set\_level}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_log\_set\_level()}{ath\_log\_set\_level()}}
{\footnotesize\ttfamily void ath\+\_\+log\+\_\+set\+\_\+level (\begin{DoxyParamCaption}\item[{const int}]{out,  }\item[{const int}]{err }\end{DoxyParamCaption})}



Sets \char`\"{}output level\char`\"{} and \char`\"{}error level\char`\"{} from input arguments, global parameters used by many functions in this file. 

Called from \mbox{\hyperlink{main_8c_a0ddf1224851353fc92bfbff6f499fa97}{main()}}, where the parameters are parsed from athinput. 

Definition at line 122 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_af21347278c9b783a269474386c4289c5}\label{ath__log_8c_af21347278c9b783a269474386c4289c5}} 
\index{ath\_log.c@{ath\_log.c}!ath\_perr@{ath\_perr}}
\index{ath\_perr@{ath\_perr}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_perr()}{ath\_perr()}}
{\footnotesize\ttfamily int ath\+\_\+perr (\begin{DoxyParamCaption}\item[{const int}]{level,  }\item[{const char $\ast$}]{fmt,  }\item[{}]{... }\end{DoxyParamCaption})}



Foutput variable argument string to \char`\"{}error log file\char`\"{}. ~\newline
 

Should be used in place of printf(stderr,...). The first argument should be\+: -\/1 \+: all processes write output 0 \+: only root process writes output 1 \+: neither root nor child processes write output 

Definition at line 261 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_a4d9be5e0a6376ae96b3de9d9bb754c10}\label{ath__log_8c_a4d9be5e0a6376ae96b3de9d9bb754c10}} 
\index{ath\_log.c@{ath\_log.c}!ath\_pout@{ath\_pout}}
\index{ath\_pout@{ath\_pout}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{ath\_pout()}{ath\_pout()}}
{\footnotesize\ttfamily int ath\+\_\+pout (\begin{DoxyParamCaption}\item[{const int}]{level,  }\item[{const char $\ast$}]{fmt,  }\item[{}]{... }\end{DoxyParamCaption})}



Output variable argument string to \char`\"{}output log file\char`\"{}. ~\newline
 

Should be used in place of printf(stdout,...). The first argument should be\+: -\/1 \+: all processes write output 0 \+: only root process writes output 1 \+: neither root nor child processes write output 

Definition at line 291 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_ad4fe019acf86bdfb9ab014b2f3ab10da}\label{ath__log_8c_ad4fe019acf86bdfb9ab014b2f3ab10da}} 
\index{ath\_log.c@{ath\_log.c}!atherr\_fp@{atherr\_fp}}
\index{atherr\_fp@{atherr\_fp}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{atherr\_fp()}{atherr\_fp()}}
{\footnotesize\ttfamily F\+I\+LE $\ast$ atherr\+\_\+fp (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Open error file if needed and return a pointer to file. 



Definition at line 213 of file ath\+\_\+log.\+c.

\mbox{\Hypertarget{ath__log_8c_ad1aa66eb6e7af73976ce23f83e38a068}\label{ath__log_8c_ad1aa66eb6e7af73976ce23f83e38a068}} 
\index{ath\_log.c@{ath\_log.c}!athout\_fp@{athout\_fp}}
\index{athout\_fp@{athout\_fp}!ath\_log.c@{ath\_log.c}}
\doxysubsubsection{\texorpdfstring{athout\_fp()}{athout\_fp()}}
{\footnotesize\ttfamily F\+I\+LE $\ast$ athout\+\_\+fp (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Open output file if needed and return a pointer to file. 



Definition at line 200 of file ath\+\_\+log.\+c.

